<!-- Tarifs_Section.html ‚Äî section tarifs dynamique li√©e √† Configuration.gs -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&display=swap" rel="stylesheet">

<style>
  :root{
    --violet: #8e44ad;      /* √©l√©ments principaux et boutons */
    --bleu:   #3498db;      /* jours, actions */
    --bleuC:  #5dade2;      /* options sp√©ciales */
    --txt:    #1f2d3d;
    --txt-soft:#6b7b8c;
    --bg:     #f6f8fb;
  }
  .tarifs-wrap{
    font-family: 'Montserrat', sans-serif;
    color: var(--txt);
    background: linear-gradient(135deg, var(--violet) 0%, var(--bleu) 100%);
    border-radius: 24px;
    padding: clamp(16px, 3vw, 28px);
    box-shadow: 0 10px 24px rgba(0,0,0,0.12);
  }
  .tarifs-inner{
    background: rgba(255,255,255,0.12);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 20px;
    padding: clamp(16px, 2.5vw, 24px);
  }
  .tarifs-title{
    font-weight: 700;
    font-size: clamp(20px, 2.4vw, 28px);
    color: #fff;
    text-align: center;
    margin: 4px 0 6px;
    letter-spacing: 0.2px;
  }
  .tarifs-sub{
    text-align: center;
    color: rgba(255,255,255,0.9);
    font-size: clamp(12px, 1.6vw, 14px);
    margin-bottom: 18px;
  }

  .cards{
    display: grid;
    grid-template-columns: repeat(3, minmax(0,1fr));
    gap: clamp(12px, 2vw, 20px);
  }
  @media (max-width: 920px){
    .cards{ grid-template-columns: 1fr; }
  }

  .card{
    background: rgba(255,255,255,0.92);
    border-radius: 16px;
    padding: clamp(14px, 2vw, 18px);
    box-shadow: 0 6px 16px rgba(0,0,0,0.08);
    transition: transform .2s ease, box-shadow .2s ease;
  }
  .card:hover{
    transform: translateY(-2px);
    box-shadow: 0 10px 22px rgba(0,0,0,0.12);
  }
  .card h3{
    margin: 0 0 10px;
    font-size: clamp(16px, 2vw, 18px);
    color: var(--txt);
  }
  .card small{ color: var(--txt-soft); }

  .bullet{
    display: grid;
    gap: 6px;
    font-size: 14px;
    line-height: 1.45;
  }

  /* Bouton g√©lule */
  .cta{
    margin-top: 18px;
    display: inline-block;
    padding: 10px 18px;
    border-radius: 999px;
    background: linear-gradient(90deg, var(--violet), var(--bleu));
    color: #fff;
    font-weight: 700;
    text-decoration: none;
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.25), 0 8px 16px rgba(0,0,0,0.15);
    transition: transform .12s ease, box-shadow .12s ease, filter .12s ease;
  }
  .cta:hover{ transform: translateY(-1px); filter: brightness(1.02); }
  .cta:active{ transform: translateY(0); filter: brightness(.98); }

  .footer{
    color: #fff; text-align: center;
    margin-top: 14px; font-size: 13px;
  }
  .footer a{ color: #fff; text-underline-offset: 2px; }
  .tag{
    display: inline-block; padding: 4px 10px; border-radius: 999px;
    background: rgba(255,255,255,0.16); color: #fff; font-size: 12px; margin-top: 6px;
  }
  .opt-note{ color: var(--txt-soft); font-size: 13px; }
  .opt-highlight{ color: var(--bleu); font-weight: 700; }
  .opt-special{ color: var(--bleuC); font-weight: 700; }
</style>

<section class="tarifs-wrap" aria-labelledby="tarifs-title">
  <div class="tarifs-inner">
    <h2 id="tarifs-title" class="tarifs-title"></h2>
    <p class="tarifs-sub" id="tarifs-sub"></p>

    <div class="cards" role="list">
      <article class="card" role="listitem" aria-labelledby="card-base-title">
        <h3 id="card-base-title">üè∫ Course de base</h3>
        <div class="bullet" id="card-base-content"></div>
        <a href="#" class="cta" id="cta-reserver" aria-label="R√©server une tourn√©e">R√©server</a>
      </article>

      <article class="card" role="listitem" aria-labelledby="card-arrets-title">
        <h3 id="card-arrets-title">‚ûï Arr√™ts suppl√©mentaires</h3>
        <div class="bullet" id="card-arrets-content"></div>
      </article>

      <article class="card" role="listitem" aria-labelledby="card-options-title">
        <h3 id="card-options-title">üóìÔ∏è Options</h3>
        <div class="bullet" id="card-options-content"></div>
        <p class="opt-note">(<span class="opt-highlight">selon dispo</span> si pr√©cis√©)</p>
      </article>
    </div>

    <div class="footer" id="tarifs-footer"></div>
  </div>
</section>

<script>
  // Initialise la section en appelant la config c√¥t√© serveur
  (function initTarifs(){
    if (google && google.script && google.script.run){
      google.script.run.withSuccessHandler(renderTarifsSection).getPublicConfig();
    } else {
      // Fallback local (utile en aper√ßu HTML hors Apps Script)
      renderTarifsSection({
        meta:{ nomService:"EL Services", zones:["Tamaris","Mar Vivo","Six-Fours-les-Plages","Sanary","Portissol","Bandol"], tvaApplicable:false, articleTVA:"Art. 293 B CGI", contact:"elservicestoulon@gmail.com", appUrl:"" },
        tarifs:{ devise:"‚Ç¨", base:{ prix:15, kmInclus:9, dureeMin:30, premierArretInclus:true }, arrets:{ second:5, troisieme:3, quatrieme:4, aPartirDuCinquieme:5 }, options:{ samediMin:25, urgent:{ delaiMin:30, prixMin:20, selonDispo:true } } }
      });
    }
  })();

  function ‚Ç¨(v, devise){ 
    const n = Number(v || 0);
    return `${n.toLocaleString('fr-FR', {maximumFractionDigits:0})} ${devise || "‚Ç¨"} net`;
  }

  function renderTarifsSection(payload){
    const { meta, tarifs } = payload;
    const devise = tarifs.devise || "‚Ç¨";

    // Titre & sous-titre
    document.getElementById('tarifs-title').textContent =
      `R√©servez vos tourn√©es pro en 1 clic sur ${meta.zones.join(', ')}`;
    document.getElementById('tarifs-sub').textContent =
      `Tarifs et options toujours √† jour, ajustables selon vos besoins.`;

    // Carte ‚Äî base
    const base = [
      `üí∂ ${‚Ç¨(tarifs.base.prix, devise)}`,
      `üìç ${tarifs.base.kmInclus} km inclus`,
      `‚è±Ô∏è ~${tarifs.base.dureeMin} min`,
      tarifs.base.premierArretInclus ? `‚úÖ 1er arr√™t inclus` : `‚ûï Arr√™ts en option`
    ];
    document.getElementById('card-base-content').innerHTML = base.map(li => `<div>${li}</div>`).join('');

    // Carte ‚Äî arr√™ts
    const arr = tarifs.arrets;
    const arretsHtml = [
      `2·µâ arr√™t : ${‚Ç¨(arr.second, devise)}`,
      `3·µâ arr√™t : ${‚Ç¨(arr.troisieme, devise)}`,
      `4·µâ arr√™t : ${‚Ç¨(arr.quatrieme, devise)}`,
      `√Ä partir du 5·µâ : ${‚Ç¨(arr.aPartirDuCinquieme, devise)}/arr√™t`
    ];
    document.getElementById('card-arrets-content').innerHTML = arretsHtml.map(li => `<div>${li}</div>`).join('');

    // Carte ‚Äî options
    const opt = tarifs.options;
    const optHtml = [
      `üìÖ <span class="opt-special">Samedi</span> : d√®s ${‚Ç¨(opt.samediMin, devise)}`,
      `‚ö° <span class="opt-highlight">Urgent</span> : d√©part sous ${opt.urgent.delaiMin} min${opt.urgent.selonDispo ? " (selon dispo)" : ""}, d√®s ${‚Ç¨(opt.urgent.prixMin, devise)}`
    ];
    document.getElementById('card-options-content').innerHTML = optHtml.map(li => `<div>${li}</div>`).join('');

    // Footer (TVA + contact)
    const tva = meta.tvaApplicable ? "TVA applicable" : `TVA non applicable (${meta.articleTVA})`;
    document.getElementById('tarifs-footer').innerHTML =
      `${tva} ‚Äî <span class="tag">Tarifs & forfaits modifiables √† tout moment par l‚Äôadministrateur</span><br>
       Tra√ßabilit√© & s√©curit√© garanties ‚Äî Confirmation et facture imm√©diates<br>
       <small>(CGV, documents officiels et conditions accessibles √† tout moment)</small><br>
       Contact : <a href="mailto:${meta.contact}">${meta.contact}</a>`;

    // Bouton R√©server ‚Üí si un appUrl est fourni, on l'utilise.
    const btn = document.getElementById('cta-reserver');
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      const target = meta.appUrl ? meta.appUrl : (new URL('?page=reservation', window.location.href)).toString();
      window.location.href = target;
    });
  }
</script>
